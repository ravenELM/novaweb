<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NOVA BOTS - Admin Panel</title>
    <style>
        :root {
            --wp-admin-theme-color: #ffffff;
            --wp-admin-theme-color--rgb: 0,124,186;
            --wp-admin-theme-color-darker-10: #006ba1;
            --wp-admin-theme-color-darker-20: #005a87;
            --wp-admin-border-width-focus: 2px;
            --wp-block-synced-color: #7a00df;
            --wp-block-synced-color--rgb: 122,0,223;
            --wp-bound-block-color: var(--wp-block-synced-color);
            --wp--preset--color--theme-0: #0b0d10;
            --wp--preset--color--theme-1: #ffffff;
            --wp--preset--color--theme-2: #66fcf1;
            --wp--preset--color--theme-3: #ffffff99;
            --wp--preset--color--theme-4: #ffffff30;
            --wp--preset--color--theme-5: #ffd638;
            --wp--preset--color--theme-6: #14151b;
            --wp--preset--color--theme-7: #21232c;
            --wp--preset--color--theme-8: #21232d;
            --wp--preset--color--theme-9: #ffffff73;
            --wp--preset--color--theme-10: #6a6a6a;
            --wp--preset--color--theme-11: #acb4be;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: var(--wp--preset--color--theme-0);
            color: var(--wp--preset--color--theme-1);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: var(--wp--preset--color--theme-0);
        }
        
        .login-box {
            background-color: var(--wp--preset--color--theme-7);
            padding: 40px;
            border-radius: 15px;
            border: 1px solid var(--wp--preset--color--theme-2);
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .login-box h2 {
            color: var(--wp--preset--color--theme-2);
            margin-bottom: 30px;
            font-size: 24px;
        }
        
        .pin-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .pin-input input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            background-color: var(--wp--preset--color--theme-8);
            border: 1px solid var(--wp--preset--color--theme-2);
            border-radius: 8px;
            color: var(--wp--preset--color--theme-1);
            outline: none;
        }
        
        .pin-input input:focus {
            border-color: var(--wp--preset--color--theme-5);
        }
        
        .login-btn {
            background-color: var(--wp--preset--color--theme-2);
            color: var(--wp--preset--color--theme-0);
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .login-btn:hover {
            background-color: var(--wp--preset--color--theme-5);
            transform: translateY(-2px);
        }
        
        .error-message {
            color: #ff6b6b;
            margin-top: 15px;
            font-size: 14px;
            display: none;
        }
        
        .admin-panel {
            display: none;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--wp--preset--color--theme-4);
            margin-bottom: 30px;
        }
        
        .admin-header h1 {
            color: var(--wp--preset--color--theme-2);
            font-size: 28px;
        }
        
        .logout-btn {
            background-color: transparent;
            color: var(--wp--preset--color--theme-1);
            border: 1px solid var(--wp--preset--color--theme-2);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background-color: var(--wp--preset--color--theme-2);
            color: var(--wp--preset--color--theme-0);
        }
        
        .add-news-section {
            background-color: var(--wp--preset--color--theme-7);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--wp--preset--color--theme-2);
            margin-bottom: 40px;
        }
        
        .add-news-section h2 {
            color: var(--wp--preset--color--theme-2);
            margin-bottom: 20px;
            font-size: 22px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            color: var(--wp--preset--color--theme-2);
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            background-color: var(--wp--preset--color--theme-8);
            border: 1px solid var(--wp--preset--color--theme-2);
            border-radius: 8px;
            color: var(--wp--preset--color--theme-1);
            font-size: 16px;
            outline: none;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            border-color: var(--wp--preset--color--theme-5);
        }
        
        .submit-btn {
            background-color: var(--wp--preset--color--theme-2);
            color: var(--wp--preset--color--theme-0);
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .submit-btn:hover {
            background-color: var(--wp--preset--color--theme-5);
            transform: translateY(-2px);
        }
        
        .news-list-section {
            background-color: var(--wp--preset--color--theme-7);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--wp--preset--color--theme-2);
        }
        
        .news-list-section h2 {
            color: var(--wp--preset--color--theme-2);
            margin-bottom: 20px;
            font-size: 22px;
        }
        
        .news-list {
            display: grid;
            gap: 20px;
        }
        
        .news-item {
            background-color: var(--wp--preset--color--theme-8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--wp--preset--color--theme-4);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .news-info {
            flex: 1;
        }
        
        .news-title {
            color: var(--wp--preset--color--theme-2);
            font-size: 18px;
            margin-bottom: 8px;
        }
        
        .news-date {
            color: var(--wp--preset--color--theme-9);
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .news-preview {
            color: var(--wp--preset--color--theme-1);
            font-size: 14px;
            line-height: 1.4;
        }
        
        .news-actions {
            display: flex;
            gap: 10px;
        }
        
        .edit-btn, .delete-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .edit-btn {
            background-color: var(--wp--preset--color--theme-5);
            color: var(--wp--preset--color--theme-0);
        }
        
        .delete-btn {
            background-color: #ff6b6b;
            color: var(--wp--preset--color--theme-0);
        }
        
        .edit-btn:hover {
            background-color: #ffc438;
            transform: translateY(-2px);
        }
        
        .delete-btn:hover {
            background-color: #ff5252;
            transform: translateY(-2px);
        }
        
        .no-news {
            text-align: center;
            padding: 40px;
            color: var(--wp--preset--color--theme-9);
        }
        
        .no-news h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--wp--preset--color--theme-2);
        }
        
        /* Image upload styles */
        .drop-zone {
            border: 2px dashed var(--wp--preset--color--theme-2);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: var(--wp--preset--color--theme-8);
            transition: all 0.3s ease;
        }
        
        .drop-zone:hover {
            background: var(--wp--preset--color--theme-7);
        }
        
        .drop-zone.dragover {
            background: var(--wp--preset--color--theme-6);
            border-color: var(--wp--preset--color--theme-5);
        }
        
        @media (max-width: 768px) {
            .news-item {
                flex-direction: column;
                gap: 15px;
            }
            
            .news-actions {
                align-self: flex-end;
            }
            
            .admin-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Login Section -->
    <div class="login-container" id="loginSection">
        <div class="login-box">
            <h2>Admin Panel Access</h2>
            <div class="pin-input">
                <input type="password" maxlength="1" class="pin-digit">
                <input type="password" maxlength="1" class="pin-digit">
                <input type="password" maxlength="1" class="pin-digit">
                <input type="password" maxlength="1" class="pin-digit">
                <input type="password" maxlength="1" class="pin-digit">
                <input type="password" maxlength="1" class="pin-digit">
            </div>
            <button class="login-btn" id="loginBtn">Enter</button>
            <div class="error-message" id="errorMessage">Incorrect PIN. Please try again.</div>
        </div>
    </div>
    
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h1>NOVA BOTS - News Management</h1>
            <div>
                <button class="logout-btn" id="logoutBtn">Logout</button>
            </div>
        </div>
        
        <!-- Add News Form -->
        <div class="add-news-section">
            <h2>Add New Article</h2>
            <form id="newsForm">
                <div class="form-group">
                    <label for="newsTitle">Title</label>
                    <input type="text" id="newsTitle" required placeholder="Enter news title">
                </div>
                <div class="form-group">
                    <label for="newsImage">Image Upload</label>
                    <div id="dropZone" class="drop-zone">
                        <p style="color: var(--wp--preset--color--theme-2); margin: 0;">Drag & drop an image here or click to select</p>
                        <input type="file" id="newsImage" accept="image/*" style="display: none;">
                    </div>
                    <img id="previewImage" style="display: none; max-width: 100%; margin-top: 15px; border-radius: 8px;">
                    <small style="color: var(--wp--preset--color--theme-9); display: block; margin-top: 5px;">
                        Supported formats: JPG, PNG, GIF. Max size: 2MB
                    </small>
                </div>
                <div class="form-group">
                    <label for="newsContent">Content</label>
                    <textarea id="newsContent" required placeholder="Enter news content"></textarea>
                </div>
                <button type="submit" class="submit-btn">Publish Article</button>
            </form>
        </div>
        
        <!-- News List -->
        <div class="news-list-section">
            <h2>Manage Articles</h2>
            <div class="news-list" id="newsList">
                <!-- News items will be loaded here -->
            </div>
            <div class="no-news" id="noNews" style="display: none;">
                <h3>No Articles Yet</h3>
                <p>Start by adding your first news article above.</p>
            </div>
        </div>
    </div>

    <script>
        // PIN configuration
        const CORRECT_PIN = "262002";
        
        // DOM elements
        const loginSection = document.getElementById('loginSection');
        const adminPanel = document.getElementById('adminPanel');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const errorMessage = document.getElementById('errorMessage');
        const pinInputs = document.querySelectorAll('.pin-digit');
        const newsForm = document.getElementById('newsForm');
        const newsList = document.getElementById('newsList');
        const noNews = document.getElementById('noNews');
        
        // Image upload elements
        const dropZone = document.getElementById('dropZone');
        const newsImageInput = document.getElementById('newsImage');
        const previewImage = document.getElementById('previewImage');
        
        // Current uploaded file
        let currentImageFile = null;

        // PIN input handling
        pinInputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                if (e.target.value && index < pinInputs.length - 1) {
                    pinInputs[index + 1].focus();
                }
            });
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !e.target.value && index > 0) {
                    pinInputs[index - 1].focus();
                }
            });
        });
        
        // Login function
        loginBtn.addEventListener('click', () => {
            const enteredPin = Array.from(pinInputs).map(input => input.value).join('');
            
            if (enteredPin === CORRECT_PIN) {
                loginSection.style.display = 'none';
                adminPanel.style.display = 'block';
                loadNews();
            } else {
                errorMessage.style.display = 'block';
                pinInputs.forEach(input => input.value = '');
                pinInputs[0].focus();
            }
        });
        
        // Logout function
        logoutBtn.addEventListener('click', () => {
            adminPanel.style.display = 'none';
            loginSection.style.display = 'flex';
            pinInputs.forEach(input => input.value = '');
            pinInputs[0].focus();
            errorMessage.style.display = 'none';
            // Reset image upload
            resetImageUpload();
        });
        
        // ========== IMAGE UPLOAD HANDLING ==========
        
        // Click to select file
        dropZone.addEventListener('click', () => {
            newsImageInput.click();
        });

        // Drag and drop handling
        ['dragover', 'dragenter'].forEach(event => {
            dropZone.addEventListener(event, (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
        });

        ['dragleave', 'dragend', 'drop'].forEach(event => {
            dropZone.addEventListener(event, (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
            });
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageSelection(files[0]);
            }
        });

        // File input change
        newsImageInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleImageSelection(e.target.files[0]);
            }
        });

        function handleImageSelection(file) {
            // Validate file type
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            if (!validTypes.includes(file.type)) {
                alert('Please select a valid image file (JPG, PNG, GIF, WebP)');
                return;
            }

            // Validate file size (2MB max)
            if (file.size > 7 * 1024 * 1024) {
                alert('Image size must be less than 2MB');
                return;
            }

            currentImageFile = file;

            // Show preview
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImage.src = e.target.result;
                previewImage.style.display = 'block';
                dropZone.querySelector('p').textContent = 'Image selected: ' + file.name;
            };
            reader.readAsDataURL(file);
        }

        function resetImageUpload() {
            newsImageInput.value = '';
            previewImage.style.display = 'none';
            previewImage.src = '';
            currentImageFile = null;
            dropZone.querySelector('p').textContent = 'Drag & drop an image here or click to select';
        }

        // Convert image file to base64 for storage
        function imageFileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
                reader.readAsDataURL(file);
            });
        }

        // ========== NEWS MANAGEMENT ==========
        
        // Server-side API endpoints (you need to create these)
        const API_BASE_URL = 'api/'; // Change this to your actual API endpoint
        
        // Load news from server
        async function loadNews() {
            try {
                // In a real implementation, you would fetch from your server
                // const response = await fetch(`${API_BASE_URL}news`);
                // const news = await response.json();
                
                // For now, we'll use localStorage but with a shared key
                const news = JSON.parse(localStorage.getItem('nova-bots-shared-news')) || [];
                
                if (news.length === 0) {
                    newsList.style.display = 'none';
                    noNews.style.display = 'block';
                    return;
                }
                
                // Sort news by date (newest first)
                news.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Clear existing news
                newsList.innerHTML = '';
                
                // Add news items
                news.forEach((article, index) => {
                    const newsItem = document.createElement('div');
                    newsItem.className = 'news-item';
                    
                    // Show image preview if available
                    const imagePreview = article.image ? 
                        `<div style="margin-bottom: 10px;">
                            <img src="${article.image}" alt="Preview" style="max-width: 100px; max-height: 60px; border-radius: 4px; border: 1px solid var(--wp--preset--color--theme-4);">
                        </div>` : '';
                    
                    newsItem.innerHTML = `
                        <div class="news-info">
                            ${imagePreview}
                            <h3 class="news-title">${article.title}</h3>
                            <div class="news-date">${new Date(article.date).toLocaleDateString('en-US', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            })}</div>
                            <p class="news-preview">${article.content.substring(0, 100)}${article.content.length > 100 ? '...' : ''}</p>
                        </div>
                        <div class="news-actions">
                            <button class="edit-btn" onclick="editNews(${index})">Edit</button>
                            <button class="delete-btn" onclick="deleteNews(${index})">Delete</button>
                        </div>
                    `;
                    newsList.appendChild(newsItem);
                });
                
                newsList.style.display = 'grid';
                noNews.style.display = 'none';
            } catch (error) {
                console.error('Error loading news:', error);
                alert('Error loading news. Please try again.');
            }
        }
        
        // Add new news article
        newsForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const title = document.getElementById('newsTitle').value;
            const content = document.getElementById('newsContent').value;
            
            let imageData = '';
            
            // Convert image to base64 if available
            if (currentImageFile) {
                try {
                    imageData = await imageFileToBase64(currentImageFile);
                } catch (error) {
                    console.error('Error converting image:', error);
                    alert('Error processing image. Please try again.');
                    return;
                }
            }
            
            // Get existing news
            const news = JSON.parse(localStorage.getItem('nova-bots-shared-news')) || [];
            
            // Add new article
            news.push({
                title,
                image: imageData,
                content,
                date: new Date().toISOString()
            });
            
            // Save to localStorage (in a real app, send to server)
            localStorage.setItem('nova-bots-shared-news', JSON.stringify(news));
            
            // In a real implementation, you would send to your server:
            /*
            try {
                const response = await fetch(`${API_BASE_URL}news`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        title,
                        image: imageData,
                        content,
                        date: new Date().toISOString()
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to save news');
                }
            } catch (error) {
                console.error('Error saving news:', error);
                alert('Error saving news. Please try again.');
                return;
            }
            */
            
            // Reset form
            newsForm.reset();
            resetImageUpload();
            
            // Reload news list
            loadNews();
            
            alert('Article published successfully!');
        });
        
        // Edit news article
        async function editNews(index) {
            const news = JSON.parse(localStorage.getItem('nova-bots-shared-news')) || [];
            const article = news[index];
            
            if (article) {
                const newTitle = prompt('Edit title:', article.title);
                if (newTitle === null) return;
                
                const newContent = prompt('Edit content:', article.content);
                if (newContent === null) return;
                
                // Update article
                news[index] = {
                    title: newTitle,
                    image: article.image, // Keep existing image
                    content: newContent,
                    date: article.date // Keep original date
                };
                
                // Save to localStorage (in a real app, send to server)
                localStorage.setItem('nova-bots-shared-news', JSON.stringify(news));
                
                // In a real implementation, you would send to your server:
                /*
                try {
                    const response = await fetch(`${API_BASE_URL}news/${index}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(news[index])
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to update news');
                    }
                } catch (error) {
                    console.error('Error updating news:', error);
                    alert('Error updating news. Please try again.');
                    return;
                }
                */
                
                // Reload news list
                loadNews();
                
                alert('Article updated successfully!');
            }
        }
        
        // Delete news article
        async function deleteNews(index) {
            if (confirm('Are you sure you want to delete this article?')) {
                const news = JSON.parse(localStorage.getItem('nova-bots-shared-news')) || [];
                
                // Remove article
                news.splice(index, 1);
                
                // Save to localStorage (in a real app, send to server)
                localStorage.setItem('nova-bots-shared-news', JSON.stringify(news));
                
                // In a real implementation, you would send to your server:
                /*
                try {
                    const response = await fetch(`${API_BASE_URL}news/${index}`, {
                        method: 'DELETE'
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to delete news');
                    }
                } catch (error) {
                    console.error('Error deleting news:', error);
                    alert('Error deleting news. Please try again.');
                    return;
                }
                */
                
                // Reload news list
                loadNews();
                
                alert('Article deleted successfully!');
            }
        }
        
        // Allow Enter key to submit PIN
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && loginSection.style.display !== 'none') {
                loginBtn.click();
            }
        });
        
        // Focus first PIN input on page load
        window.onload = () => {
            pinInputs[0].focus();
        };
    </script>
</body>
</html>